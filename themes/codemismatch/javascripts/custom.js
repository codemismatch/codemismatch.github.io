function navigateTo(e,t=!0){state.currentPage=e,t&&window.history.pushState({page:e},"",`#${e}`),document.querySelectorAll(".page-section").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".nav-link").forEach(e=>{e.classList.remove("text-brand-600","font-bold")});const n=document.querySelector(`.nav-link[data-page="${e}"]`);n&&n.classList.add("text-brand-600","font-bold");if(({home:["section-hero","section-services","section-work"],services:["section-services"],work:["section-work"],contact:["section-contact"],architect:["section-architect"],open_source:["section-placeholder"],blog:["section-placeholder"]}[e]||[]).forEach(e=>document.getElementById(e)?.classList.add("active")),"open_source"===e){const e=document.getElementById("placeholder-title");e&&(e.innerText="Open Source Initiatives")}else if("blog"===e){const e=document.getElementById("placeholder-title");e&&(e.innerText="Engineering Blog")}"architect"===e&&setTimeout(()=>{const e=document.getElementById("chat-messages");e&&(e.scrollTop=e.scrollHeight)},100),window.scrollTo(0,0)}function toggleMobileMenu(){const e=document.getElementById("mobile-menu");e&&e.classList.toggle("hidden")}function toggleMobileProducts(){const e=document.getElementById("mobile-products-list"),t=document.getElementById("mobile-product-icon");e&&(e.classList.toggle("hidden"),t&&(t.style.transform=e.classList.contains("hidden")?"rotate(0deg)":"rotate(180deg)"))}function setTheme(e){state.currentTheme=e;const t=THEMES[e],n=document.documentElement;Object.entries(t.variables).forEach(([e,t])=>{n.style.setProperty(e,t)}),["void","azure","paper"].forEach(t=>{const n=document.getElementById(`btn-theme-${t}`);n&&(n.className=t===e?"w-full text-left px-3 py-2 rounded font-mono text-xs bg-brand-600 text-white":"w-full text-left px-3 py-2 rounded font-mono text-xs hover:bg-skin-surface-hover text-skin-text")});const a=document.getElementById("wave-controls-horizontal"),o=document.getElementById("wave-controls-vertical"),r=document.getElementById("wave-controls-knob");"paper"===e?(a&&a.classList.add("hidden"),o&&o.classList.remove("hidden"),r&&r.classList.add("hidden")):"void"===e?(a&&a.classList.add("hidden"),o&&o.classList.add("hidden"),r&&r.classList.remove("hidden")):(a&&a.classList.remove("hidden"),o&&o.classList.add("hidden"),r&&r.classList.add("hidden"))}function toggleThemePanel(){const e=document.getElementById("theme-panel");e&&e.classList.toggle("hidden")}function hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}function mixColors(e,t,n){return{r:Math.round(e.r*(1-n)+t.r*n),g:Math.round(e.g*(1-n)+t.g*n),b:Math.round(e.b*(1-n)+t.b*n)}}function toRgba(e,t){const{r:n,g:a,b:o}=hexToRgb(e);return`rgba(${n}, ${a}, ${o}, ${t})`}function generatePalette(e,t){const n=hexToRgb(e),a={r:255,g:255,b:255},o={r:0,g:0,b:0},r=(e,t)=>{const a=mixColors(e,n,t);return`${a.r} ${a.g} ${a.b}`},s={};return[.05,.1,.25,.45,.7,.85].forEach((e,n)=>{s[`--${t}-${[50,100,200,300,400,500][n]}`]=r(a,e)}),s[`--${t}-600`]=`${n.r} ${n.g} ${n.b}`,[.2,.35,.55,.75].forEach((e,n)=>{s[`--${t}-${[700,800,900,950][n]}`]=r(o,e)}),s}function updateBrandColor(e){state.brandColor=e;const t=document.getElementById("brand-color-picker"),n=document.getElementById("brand-color-label");t&&(t.value=e),n&&(n.innerText=e);const a=generatePalette(e,"brand");Object.entries(a).forEach(([e,t])=>document.documentElement.style.setProperty(e,t))}function updateAmbientColor(e){state.ambientColor=e;const t=document.getElementById("ambient-color-picker"),n=document.getElementById("ambient-color-label");t&&(t.value=e),n&&(n.innerText=e);const a=generatePalette(e,"ambient");Object.entries(a).forEach(([e,t])=>document.documentElement.style.setProperty(e,t))}function resetColors(){updateBrandColor("#00608a"),updateAmbientColor("#0f172a")}function clampWaveParam(e,t){const n=WAVE_LIMITS[e];if(!n)return t;const a=parseFloat(t);return Number.isNaN(a)?n.min:Math.min(n.max,Math.max(n.min,a))}function setupWaveAnimation(){function e(){o=n.parentElement.offsetWidth,r=n.parentElement.offsetHeight,n.width=o*window.devicePixelRatio,n.height=r*window.devicePixelRatio,a.setTransform(1,0,0,1,0,0),a.scale(window.devicePixelRatio,window.devicePixelRatio)}function t(){if(a.clearRect(0,0,o,r),m&&!m.checked)return void requestAnimationFrame(t);const e=THEMES[state.currentTheme].isDark,n=e?.9:.6,i=r/2;a.font='700 11px "IBM Plex Mono", monospace',a.textBaseline="middle";const d=e?CODE_GRADIENT.dark:CODE_GRADIENT.light,l=state.wave.renderMode||"code";[{timeModifier:1,lineWidth:2,amplitude:50,wavelength:200,gradient:[`rgba(59, 130, 246, ${n})`,`rgba(6, 182, 212, ${n})`,`rgba(168, 85, 247, ${n})`,`rgba(236, 72, 153, ${n})`]},{timeModifier:.5,lineWidth:1.5,amplitude:140,wavelength:300,gradient:[`rgba(30, 58, 138, ${.8*n})`,`rgba(37, 99, 235, ${.8*n})`,`rgba(79, 70, 229, ${.8*n})`]},{timeModifier:.7,lineWidth:1,amplitude:90,wavelength:240,gradient:[`rgba(88, 28, 135, ${.7*n})`,`rgba(124, 58, 237, ${.7*n})`,`rgba(30, 64, 175, ${.7*n})`]},{timeModifier:1.1,lineWidth:.5,amplitude:30,wavelength:120,gradient:[`rgba(59, 130, 246, ${.4*n})`,`rgba(147, 197, 253, ${.4*n})`]},{timeModifier:2,lineWidth:1,amplitude:-50,wavelength:15,gradient:[`rgba(59, 130, 246, ${n})`,`rgba(6, 182, 212, ${n})`]},{timeModifier:1,lineWidth:2,amplitude:-100,wavelength:30,gradient:[`rgba(30, 58, 138, ${.8*n})`,`rgba(37, 99, 235, ${.8*n})`]},{timeModifier:.5,lineWidth:1,amplitude:-200,wavelength:60,gradient:[`rgba(88, 28, 135, ${.7*n})`,`rgba(124, 58, 237, ${.7*n})`]},{timeModifier:.25,lineWidth:3,amplitude:-160,wavelength:40,gradient:[`rgba(59, 130, 246, ${.6*n})`,`rgba(147, 197, 253, ${.6*n})`]},{timeModifier:.35,lineWidth:2,amplitude:-240,wavelength:70,gradient:[`rgba(168, 85, 247, ${.5*n})`,`rgba(236, 72, 153, ${.5*n})`]}].forEach((e,t)=>{const r=e.amplitude*s.amp,c=e.wavelength/s.freq,m=2*Math.PI/c;if("lines"===l){a.beginPath(),a.lineWidth=e.lineWidth;const n=a.createLinearGradient(0,0,o,0);e.gradient.forEach((t,a)=>n.addColorStop(a/(e.gradient.length-1),t)),a.strokeStyle=n;for(let n=0;n<o;n+=5){const d=o>0?n/o:0,l=r*Math.pow(d,s.steepness),c=i+Math.sin(m*n+u*e.timeModifier)*l*Math.sin(.2*u+t)+Math.cos(.01*n+u)*(.2*l);0===n?a.moveTo(n,c):a.lineTo(n,c)}a.stroke()}else{const l=8,c=90;for(let g=0;g<o+l;g+=l){let f=g-c*u*(t%2==0?1:-1);f%=o+l,f<-l&&(f+=o+l);const h=Math.max(0,Math.min(o,f)),p=o>0?h/o:0,v=r*Math.pow(p,s.steepness),b=i+Math.sin(m*f+u*e.timeModifier)*v*Math.sin(.2*u+t)+Math.cos(.01*f+u)*(.2*v),w=.5+.5*Math.sin(2*u+.08*g+t),E=Math.min(1,Math.max(.4,n*(.6+.4*w))),x=Math.min(1,Math.max(0,p)),y=(Math.floor(x*(d.length-1))+t)%d.length,I=d[y];a.fillStyle=toRgba(I,E);const M=Math.floor(g/l)+3*t;let B;if(M%12<3){const e=M%CODE_HEX.length;B=CODE_HEX[e]}else{const e=M%CODE_BINARY.length;B=CODE_BINARY[e]}a.fillText(B,f,b)}}}),u+=.008*s.speed,requestAnimationFrame(t)}console.log("Initializing Wave Animation...");const n=document.getElementById("wave-canvas");if(!n)return void console.error("Wave canvas not found!");const a=n.getContext("2d");let o,r;const s=state.wave.params;window.addEventListener("resize",e),e();const i={speed:{horizontal:document.getElementById("wave-speed"),vertical:document.getElementById("wave-speed-v"),knob:document.getElementById("wave-speed-knob"),labelH:document.getElementById("wave-speed-val"),labelV:document.getElementById("wave-speed-val-v"),labelK:document.getElementById("wave-speed-val-knob"),formatH:e=>`${e.toFixed(3)}x`,formatV:e=>e.toFixed(3),formatK:e=>`${e.toFixed(3)}x`},freq:{horizontal:document.getElementById("wave-freq"),vertical:document.getElementById("wave-freq-v"),knob:document.getElementById("wave-freq-knob"),labelH:document.getElementById("wave-freq-val"),labelV:document.getElementById("wave-freq-val-v"),labelK:document.getElementById("wave-freq-val-knob"),formatH:e=>`${e.toFixed(3)}x`,formatV:e=>e.toFixed(3),formatK:e=>`${e.toFixed(3)}x`},amp:{horizontal:document.getElementById("wave-amp"),vertical:document.getElementById("wave-amp-v"),knob:document.getElementById("wave-amp-knob"),labelH:document.getElementById("wave-amp-val"),labelV:document.getElementById("wave-amp-val-v"),labelK:document.getElementById("wave-amp-val-knob"),formatH:e=>`${e.toFixed(3)}x`,formatV:e=>e.toFixed(3),formatK:e=>`${e.toFixed(3)}x`},steepness:{horizontal:document.getElementById("wave-steepness"),vertical:document.getElementById("wave-steepness-v"),knob:document.getElementById("wave-steepness-knob"),labelH:document.getElementById("wave-steepness-val"),labelV:document.getElementById("wave-steepness-val-v"),labelK:document.getElementById("wave-steepness-val-knob"),formatH:e=>e.toFixed(3),formatV:e=>e.toFixed(2),formatK:e=>e.toFixed(2)}},d=e=>{const t=i[e];if(!t||!t.knob)return;const n=document.querySelector(`svg[data-knob="${e}"]`);if(!n)return;const a=n.querySelector(".knob-arc"),o=n.querySelector(".knob-handle");if(!a)return;const r=WAVE_LIMITS[e],d=s[e],l=r?(d-r.min)/(r.max-r.min):0,c=Math.min(1,Math.max(0,l)),m=15,g=18,u=18,f=30,h=340;if(c<=0)a.setAttribute("d","");else{const e=f+(h-f)*c,t=f*Math.PI/180,n=e*Math.PI/180,o=`M ${g+m*Math.cos(t)} ${u+m*Math.sin(t)} A ${m} ${m} 0 ${e-f>180?1:0} ${1} ${g+m*Math.cos(n)} ${u+m*Math.sin(n)}`;a.setAttribute("d",o)}if(o){const e=f*Math.PI/180,t=e+(h*Math.PI/180-e)*c,n=m,a=g+n*Math.cos(t),r=u+n*Math.sin(t);o.setAttribute("cx",a.toString()),o.setAttribute("cy",r.toString())}},l=e=>{const t=i[e];if(!t)return;const n=s[e];t.horizontal&&(t.horizontal.value=n),t.vertical&&(t.vertical.value=n),t.labelH&&(t.labelH.innerText=t.formatH?t.formatH(n):n.toFixed(3)),t.labelV&&(t.labelV.innerText=t.formatV?t.formatV(n):n.toFixed(3)),t.knob&&(t.knob.value=n),t.labelK&&(t.labelK.innerText=t.formatK?t.formatK(n):n.toFixed(3)),d(e)},c=(e,t)=>{s[e]=clampWaveParam(e,t),l(e)};Object.entries(i).forEach(([e,t])=>{t.horizontal&&t.horizontal.addEventListener("input",t=>c(e,t.target.value)),t.vertical&&t.vertical.addEventListener("input",t=>c(e,t.target.value)),t.knob&&t.knob.addEventListener("input",t=>c(e,t.target.value))}),Object.entries(i).forEach(([e,t])=>{const n=t.horizontal?.value??t.vertical?.value??s[e];c(e,n)});const m=document.getElementById("wave-toggle"),g=document.getElementById("wave-code-toggle");g&&(state.wave.renderMode=g.checked?"code":"lines",g.addEventListener("change",()=>{state.wave.renderMode=g.checked?"code":"lines"}));let u=0;t()}function appendMessage(e,t){const n=document.getElementById("chat-messages");if(!n)return;const a="model"===e,o=document.createElement("div");o.className=`flex gap-4 ${a?"flex-row":"flex-row-reverse"} animate-fade-in`;const r=t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");o.innerHTML=`\n    <div class="flex-shrink-0 w-8 h-8 flex items-center justify-center border ${a?"border-brand-600 bg-brand-600/10 text-brand-600":"border-skin-border bg-skin-base text-skin-muted"}">\n      <i data-lucide="${a?"activity":"user"}" class="w-4 h-4"></i>\n    </div>\n    <div class="max-w-[85%] font-mono text-sm p-4 border shadow-sm ${a?"border-brand-600/30 bg-skin-base text-skin-text":"border-skin-border bg-skin-surface-hover text-skin-text"}">\n      ${r}\n    </div>\n  `,n.appendChild(o),"undefined"!=typeof lucide&&lucide.createIcons(),n.scrollTop=n.scrollHeight}function renderChat(){const e=document.getElementById("chat-messages");e&&(e.innerHTML="",state.messages.forEach(e=>appendMessage(e.role,e.text)))}async function handleChatSend(){const e=document.getElementById("chat-input");if(!e)return;const t=e.value.trim();if(!t)return;state.messages.push({id:Date.now(),role:"user",text:t}),appendMessage("user",t),e.value="";const n=document.getElementById("chat-loading");n&&n.classList.remove("hidden");try{const e="The Architect is currently offline. API integration required.";state.messages.push({id:Date.now()+1,role:"model",text:e}),appendMessage("model",e)}catch(e){console.error(e),appendMessage("model","Error: Signal lost.")}finally{n&&n.classList.add("hidden")}}function parseWavePrompt(e){const t=e.toLowerCase(),n={...state.wave.params};let a=!1;const o=(e,o)=>{e.some(e=>t.includes(e))&&(Object.entries(o).forEach(([e,t])=>{n[e]=clampWaveParam(e,t)}),a=!0)};return o(["storm","thunder","chaos","angry","wild"],{speed:2.4,freq:1.5,amp:2.1,steepness:4.2}),o(["calm","gentle","serene","smooth","quiet"],{speed:.35,freq:.35,amp:.6,steepness:.9}),o(["fast","rapid","hurry","speed"],{speed:1.8}),o(["slow","relax","drift","lag"],{speed:.45}),o(["choppy","tight","busy","jitter"],{freq:1.6,steepness:3.5}),o(["long","rolling","wide","swell"],{freq:.3}),o(["high","tall","big","huge"],{amp:2}),o(["low","flat","shallow","small"],{amp:.7}),o(["sharp","spiky","pointy"],{steepness:4.5}),o(["round","soft","smooth"],{steepness:.8}),{params:n,matched:a}}function updateWaveControlsFromParams(e){const t={speed:["wave-speed","wave-speed-v"],freq:["wave-freq","wave-freq-v"],amp:["wave-amp","wave-amp-v"],steepness:["wave-steepness","wave-steepness-v"]};Object.entries(t).forEach(([t,n])=>{if(void 0===e[t])return;const a=clampWaveParam(t,e[t]),o=n.map(e=>document.getElementById(e)).find(Boolean);o&&(o.value=a,o.dispatchEvent(new Event("input",{bubbles:!0})))})}function applyWavePrompt(){const e=document.getElementById("wave-prompt");if(!e)return;const t=e.value.trim();if(!t)return;console.log("AI Wave Prompt:",t);const{params:n,matched:a}=parseWavePrompt(t);a&&updateWaveControlsFromParams(n);const o=document.querySelector('button[onclick="applyWavePrompt()"]');if(o){const e=o.innerText;o.innerText=a?"Parameters Optimized":"No Keywords Detected",o.classList.toggle("bg-green-600",a),o.classList.toggle("bg-yellow-600",!a),setTimeout(()=>{o.innerText=e,o.classList.remove("bg-green-600","bg-yellow-600")},2e3)}}const WAVE_DEFAULTS={speed:.896,freq:.198,amp:1.356,steepness:1.4},WAVE_LIMITS={speed:{min:0,max:5},freq:{min:.1,max:3},amp:{min:0,max:3},steepness:{min:.1,max:10}},CODE_BINARY=["0","1"],CODE_HEX=["0x0F","0x4F","0xA1","0x7E","0x3C"],CODE_GRADIENT={light:["#3b82f6","#06b6d4","#6366f1","#8b5cf6","#ec4899"],dark:["#93c5fd","#67e8f9","#a5b4fc","#c4b5fd","#f9a8d4"]};let state={currentPage:"home",currentTheme:"azure",brandColor:"#00608a",ambientColor:"#0f172a",messages:[{id:"init",role:"model",text:"I am The Architect. I serve as the cognitive interface for CodeMismatch. How may I assist with your enterprise strategy?"}],wave:{params:{...WAVE_DEFAULTS},renderMode:"code"}};const THEMES={void:{variables:{"--bg-base":"#020408","--bg-surface":"#0f1419","--bg-surface-hover":"#1a202c","--text-main":"#f8fafc","--text-muted":"#9ca3af","--border-color":"#1a202c","--card-border":"#1a202c"},isDark:!0},azure:{variables:{"--bg-base":"#f8fafc","--bg-surface":"#ffffff","--bg-surface-hover":"#f1f5f9","--text-main":"#0f172a","--text-muted":"#64748b","--border-color":"#e2e8f0","--card-border":"#e2e8f0"},isDark:!1},paper:{variables:{"--bg-base":"#fafafa","--bg-surface":"#ffffff","--bg-surface-hover":"#f1f5f9","--text-main":"#0f172a","--text-muted":"#64748b","--border-color":"#cbd5e1","--card-border":"#e2e8f0"},isDark:!1}};document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof lucide&&lucide.createIcons(),window.setTheme?window.setTheme(state.currentTheme):setTheme(state.currentTheme),resetColors(),setupWaveAnimation();navigateTo(window.location.hash.slice(1)||"home",!1),renderChat();const e=document.getElementById("brand-color-picker"),t=document.getElementById("ambient-color-picker"),n=document.getElementById("chat-input");e&&e.addEventListener("input",e=>updateBrandColor(e.target.value)),t&&t.addEventListener("input",e=>updateAmbientColor(e.target.value)),n&&n.addEventListener("keydown",e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),handleChatSend())}),window.addEventListener("popstate",e=>{e.state&&e.state.page&&navigateTo(e.state.page,!1)})}),window.navigateTo=navigateTo,window.toggleMobileMenu=toggleMobileMenu,window.toggleMobileProducts=toggleMobileProducts,window.setTheme=setTheme,window.toggleThemePanel=toggleThemePanel,window.updateBrandColor=updateBrandColor,window.updateAmbientColor=updateAmbientColor,window.resetColors=resetColors,window.handleChatSend=handleChatSend,window.applyWavePrompt=applyWavePrompt;